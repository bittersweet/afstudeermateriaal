\documentclass[12pt,a4paper]{article}

% Number pages on the bottom
\pagestyle{plain}

% Use Dutch language so we get correct hyphenation
\usepackage[dutch]{babel}
\selectlanguage{dutch}

% Use the Palatino font
\usepackage{palatino}

% Enables fullpage mode, 1 inch margin instead of 2.
\usepackage{fullpage}

\title{Professionalisering Fullmoon}

\author{Mark Mulder}
\date{mei 2009}

\begin{document}

% Enables the right ragged environment and indents the paragraph by 0.5 inch
% \raggedright
% \parindent=0.5in 
  
  \maketitle
  \pagebreak
  
  \tableofcontents  
  \pagebreak
  
  \section{Introductie}

  Tijdens mijn stageperiode bij Fullmoon Interactive Solutions kreeg ik in de gaten dat er af en toe wat situaties waren waarbij het samenwerken niet helemaal goed ging. Denk hierbij aan meerdere mensen die aan hetzelfde project bezig waren, en elkaars werk daarbij per ongeluk hadden overgeschreven. Er was niet echt een goed overzicht wie wat deed. Omdat ik hiervoor al ervaring had opgedaan met Source Control Management {\sc (scm)} systemen dacht ik hun hierbij goed te kunnen helpen.
    
    Omdat ik toen nog druk bezig met m'n stagewerkzaamheden hadden we besloten om hier een afstudeerproject van te maken. De zaken die ik bij Fullmoon wil verbeteren zijn veel voorkomend, ik weet zeker dat veel Interactieve Media studenten en andere klein tot middelgrote bedrijven hier ook mee te maken hebben. 
    
    Daarom ga ik in navolging van dit document, waar ik in ga op de specifieke situatie bij Fullmoon een ander document opstellen waarin globale adviezen en oplossingen staan. Hierdoor kunnen veel mensen van mijn werk bij Fullmoon profiteren.
    
    
  \section{Eisen professionaliteit}

  Om de huidige situatie in kaart te brengen heb ik een aantal punten opgesteld waar een bedrijf aan moet voldoen om professioneel te kunnen werken. Het gaat hierbij om een klein tot middelgroot bedrijf.

  \begin{enumerate}
    \item Medewerkers moeten gelijktijdig kunnen samenwerken aan hetzelfde project zonder elkaar hierbij in de weg te zitten.
    \item Er moet een overzicht zijn van wat er gebeurd. Wie heeft wat aangepast en wanneer, waar is iedereen mee bezig?
    \item Er moet een goede ontwikkelomgeving zijn, gebaseerd op een OTAP \footnote{Ontwikkel, Test, Acceptatie, Productie} straat.
    \item Al het gemaakte werk moet goed gebackupped kunnen worden, zowel de productie als development omgevingen. Er moet geen versie van een bestand verloren kunnen gaan en men moet altijd terug kunnen gaan naar een vorige versie van een bestand.
    \item Klanten moeten in het ontwikkelproces betrokken kunnen worden zodat wijzigingen en dergelijke beoordeeld kunnen worden in een omgeving die los staat van de live omgeving.
  \end{enumerate}

  \section{Inventarisatie huidige situatie}
  
  Bij punt 1 ligt bij Fullmoon grote ruimte tot verbetering. In de tijd dat ik bij hun aan het stagelopen was kwam het vaak voor dat werk van elkaar overschreven werd, waarna het dus verloren was. Als mensen tegelijkertijd aan hetzelfde project bezig waren kwam het vaak voor dat er over en weer geroepen werd om er achter te komen wie er in een bepaald bestand zat te werken. Iedereen werkt direct op de server, dus een bestand kon eigenlijk maar door \'{e}\'{e}n iemand bewerkt worden.
  
  Punt 2 is ook niet erg goed aanwezig. Iedereen heeft wel in de gaten wie er verdeeld is over de verschillende projecten maar er is geen goed zicht over wie nou daadwerkelijk wat aan het doen is.
  
  Op dit moment is de ontwikkelstraat van Fullmoon erg klein, het gaat van ontwikkeling naar productie. Hierbij werkt iedereen tezamen in de ontwikkelomgeving, waar zoals gemeld, veel problemen door ontstaan. Ook is er bij het updaten van sites vaak onoverzichtelijkheid omdat de persoon soms vergeet wat er allemaal veranderd is.
  
  Van databases die op de eigen server van Fullmoon staan wordt er elke nacht een backup gemaakt. Deze worden ook offsite opgeslagen door de hosting provider van Fullmoon, Cyso, die ze een maand lang bewaard. Normale bestanden op de ontwikkelserver worden ook dagelijks op een aparte hardeschijf opgeslagen. Met dagelijkse snapshots is de backup vrij goed geregeld.
  
  Voor klanten is het soms gewenst dat zij nieuwe functionaliteit uittesten in hun websites voordat deze live gaan. Op dit moment bestaat deze mogelijkheid nog niet bij Fullmoon. Veranderingen worden eerst lokaal gedaan waarna ze in \'{e}\'{e}n keer online gaan. De klant (samen met de bezoekers) test deze veranderingen dus op de live omgeving.

  \section{Eisen en wensen}
  
  Samen met Fullmoon ben ik op de volgende eisen en wensen gekomen. Deze zien ze graag ingevoerd worden naast de adviezen die ik nog aandraag.
  
    \subsection{Eisen}
    
    \begin{itemize}
      \item De nieuwe situatie moet voor iedereen te begrijpen zijn.
      \item Er moeten niet al te ingrijpende veranderingen komen in de al bestaande workflow.
    \end{itemize}
    
    \subsection{Wensen}
    
    \begin{itemize}
      \item Een ticketsysteem waarin bugs en featurerequests komen en waarin werknemers hun uren die ze aan verschillende projecten besteden goed kunnen bijhouden.
      \item Een makkelijk synchronisatieproces tussen live en development databases zodat lokaal met live gegevens gewerkt kunnen worden.
    \end{itemize}
  
  \section{Wat moet er veranderen}
  
  Er zijn een aantal hoofdzaken die verbeterd moeten worden, namelijk; het gelijktijdig kunnen samenwerken en het ontwikkelproces.
  
  Hier onder volgen mijn adviezen om de gewenste verbeteringen hierin te kunnen verwezenlijken.
  
  \begin{enumerate}
    \item Gebruik maken van een {\sc scm} systeem. Dit faciliteert gelijktijdig het beter kunnen 
    samenwerken en zorgt ervoor dat er een historie aanwezig is van veranderingen in bestanden. Om een 
    goed overzicht te krijgen van wat iedereen doet is dit ook een onmisbaar onderdeel.
    \item Het daadwerkelijke ontwikkelen verplaatsen van de centrale server waar iedereen tegelijkertijd op werkt naar de workstations van de medewerkers. In samenwerking met het {\sc scm} systeem kan iedereen wel onafhankelijk van elkaar werken aan hetzelfde project.
    \item Een ontwikkelstraat in gebruik nemen zodat het huidige tweeledige proces van ontwikkeling $\to$ productie veranderd in een uitgebreidere versie. Naast de voordelen die dit bied voor samenwerken kan ook de klant deelnemen aan het proces door wijzigingen uit te testen in de acceptatie omgeving alvorens deze online gezet worden.
    \item Het synchroniseren van verschillende databases moet makkelijker worden. Hiermee bedoel ik dat de lokale ontwikkel omgeving kan werken met data uit de live database. Het werken met live data biedt erg veel voordelen en hierdoor kan je problemen oplossen waar je anders niet tegenaan gelopen was. Daarnaast wil ik aanraden om de databases ook zelf offsite te bewaren, om een nog hogere mate van veiligheid en onafhankelijkheid te cre\"{e}ren.
    \item Het updaten van sites moet geautomatiseerd worden, om fouten die ontstaan tijdens het handmatig updaten hiervan uit de weg te kunnen gaan.
  \end{enumerate}
  
  \section{Advies}

  Wat volgt is een onderzoek naar deze adviespunten en hieruit zal ik naar mijn mening de beste optie voor Fullmoon naar voren laten komen.
  
    \subsection{SCM Systeem}
    
    Tegenwoordig zijn er heel veel {\sc scm} systemen om uit te kiezen. Een kleine greep uit het aanbod: \emph{CVS, Subversion, Git, Mercurial} en \emph{Bazaar}.
    
    Al deze systemen bieden veel voordeel voor Fullmoon. Het opslaan van verschillende versies van bestanden tijdens het ontwikkelproces is van onmisbaar belang. Het biedt erg veel veiligheid want als er bijvoorbeeld iets fout gaat kan er makkelijk terug gegaan worden naar een vorige (wel werkende) versie. Ook zorgt het er voor dat er beter samengewerkt kan worden. Dit werkt op verschillende manieren:
    
    \begin{enumerate}
      \item \textbf{Lock-Modify-Unlock} Als iemand een bestand aan het bewerken is wordt deze gelocked zodat andere mensen dit bestand niet kunnen aanpassen.
      \item \textbf{Copy-Modify-Merge} Hierbij werkt iedereen op zijn of haar eigen versie van een bestand waarna de eventuele wijzigingen van andere developers hierin kunnen worden gemerged. 
    \end{enumerate}
    
    Hiernaast biedt een {\sc scm} systeem de mogelijkheid om te \emph{branchen} (als het ware een nieuwe tak aanmaken gebaseerd op de huidige sourcecode). Hierbij kan je wijzigingen aanbrengen in een aparte versie zodat de \emph{trunk} (hoofd branch) van je code altijd stabiel blijft. Nadat de wijzigingen zijn getest kunnen ze in de stabiele versie worden ge\"{i}ntegreerd. Dit bevorderd ook experimentatie, omdat het weinig moeite kost om te schakelen tussen verschillende versies is het ``goedkoop'' om dingen uit te proberen.
    
    Alle genoemde systemen bieden deze mogelijkheden, dus de keuze hangt af van andere variabelen. Zo was het uitgangspunt dat de nieuwe situatie voor iedereen te begrijpen moest zijn, het werken met {\sc scm} moet dus niet al te moeilijk worden. CVS en Subversion bestaan het langste en hier zijn erg goede grafische tools voor. Dit ontbreekt nog bij de andere genoemde systemen en om hier mee te kunnen werken is het vaak een commandline aangelegenheid. Dit gaat te technisch worden voor veel medewerkers dus ligt de keuze tussen CVS en Subversion.
    
    Door nader onderzoek ben ik er achter gekomen dat CVS een aantal nadelen heeft ten opzichte van Subversion, die zijn als volgt:
    
    \begin{itemize}
      \item Geen besef van changesets, wijzigingen zijn altijd per file.
      \item Alle operaties duren een stuk langer, wat fijn werken in de weg staat. Tagging of branching kan een erg lange tijd in beslag nemen.
      \item Je kan files of directories niet verplaatsen of kopi\"{e}ren.
      \item Geen goede ondersteuning voor binaire bestandsformaten.
      \item Je kan geen permissies toewijzen op de repository.
      \item Geen ``atomic commits'', het in \'{e}\'{e}n keer versturen van alle wijzigingen naar de server. Als de update niet slaagt door bijvoorbeeld een netwerkstoring wordt de commit afgebroken. CVS verstuurd alle bestanden apart waardoor je geen garantie hebt dat alles goed bij de repository overkomt waarna deze misschien in een onstabiele staat zal verkeren.
    \end{itemize}
    
    \paragraph{Naar mijn mening is CVS echt een \emph{legacy} systeem en is het niet flexibel genoeg om te gebruiken in een hedendaags webdevelopment-bedrijf, daarom wil ik Fullmoon het advies geven om Subversion te gebruiken.}
    
    \subsection{Gescheiden werken}
    
    Doordat iedereen onafhankelijk van elkaar moet kunnen werken aan hetzelfde project is het noodzaak dat het ontwikkelen wordt verplaats van de centrale server naar de workstations van de medewerkers zelf. Iedereen zal dus een kopie van het project gaan draaien op hun eigen computer. Om dit te bewerkstelligen zal het nodig zijn om een webserver te draaien.
    
    Bij Fullmoon is de situatie als volgt:
    
    \begin{itemize}
      \item De werknemers draaien Windows XP of Vista.
      \item Alle websites die worden gemaakt gebruiken Apache \footnote{De websites gebruiken uitsluitend .htaccess bestanden.} en PHP.
    \end{itemize}
    
    Er zijn veel applicaties die het mogelijk makken om een webserver te draaien maar door deze specifieke situatie kunnen we het inperken tot een oplossing voor Windows die Apache en PHP ondersteund.
    
    Met redelijk veel moeite is het mogelijk om Apache en PHP zelf te installeren op Windows maar voor de Fullmoon werknemers heb ik liever een kant en klare oplossing. Er zijn er een aantal:
    
    \begin{itemize}
      \item Wampserver
      \item Xampp
      \item PHPdev
      \item PHPtriad
    \end{itemize}
    
    Ik heb ze alle vier uitgeprobeerd en PHPdev en PHPtriad vielen gelijk weg, de installatie hiervan is te omslachtig en er komen te veel nutteloze zaken bij. Wampserver en Xampp hebben hierintegen een erg makkelijke installatie en geven je een controlepaneel waarmee je alles voor Apache en PHP kunt regelen. Hiernaast biedt Xampp ook nog de mogelijkheid om Apache met een paar klikken te laten installeren als een service waardoor het altijd beschikbaar is.
    
    \paragraph{Xampp werkt naar mijn mening het beste en is erg geschikt voor de medewerkers van Fullmoon.}
    
    \subsection{Ontwikkelstraat}
    
    Om problemen uit de weg te gaan bij het samenwerken hebben we het al gehad over het gescheiden werken, maar het is zaak dat we dit nog verder trekken tot een echte ontwikkelstraat. De \emph{tried and tested} oplossing hiervoor is de {\sc otap} straat, wat staat voor Ontwikkeling, Test, Acceptatie en Productie, het proces verloopt hierin als volgt:
    
    \begin{quote}
      Een programmeur of ontwerper werkt aan een website in een ontwikkelomgeving, als hij klaar is met zijn werk wordt het doorgestuurd naar de Test omgeving. Daar wordt getest of het allemaal werkt zoals het zou moeten en als dat zo is gaat het verder naar de Acceptatie omgeving. Dit is een omgeving waarin de klant wordt betrokken, deze kan dan beoordelen of er aan zijn wensen en eisen is voldaan. Indien dit allemaal wordt goedgekeurd volgt de laatste stap, de Productie omgeving.
    \end{quote}
    
    Voor Fullmoon wil ik een vorm van de {\sc otap} straat invoeren. Het zal meer op een {\sc otp} straat lijken aangezien Fullmoon heeft aangegeven dat niet elke klant betrokken hoeft te worden in het ontwikkelproces. Voor websites waar een kleine wijziging op uitgevoerd moet worden is het namelijk niet nodig en is het afdoende dat het intern getest wordt.
    
    De situatie zal er als volgt uit gaan zien:
    
    \begin{itemize}
      \item \textbf{Ontwikkeling} gebeurd bij de werknemers op hun eigen computer.
      \item \textbf{Testen} zal gebeuren op de repository server waar altijd de laatste versie draait van een website.
      \item \textbf{Acceptatie} vind ook hier op plaats, er kan een site gehost worden gebaseerd op een specifieke \emph{tag} of \emph{branch} welke de klant kan bezoeken. Hierdoor kan Fullmoon door blijven developen terwijl de klant toch naar \'{e}\'{e}n specifieke versie van de site kan kijken.
      \item \textbf{Productie} is op de live server.
    \end{itemize}
    
    \paragraph{Fullmoon zal gebruik maken van een {\sc ot(a)p} straat om de kwaliteit van het werk te waarborgen tijdens het ontwikkelingsproces en de inspraak van klanten te vergemakkelijken.}
    
    \subsection{Database synchronisatie en backup}
    
    \subsubsection{Synchronisatie}
    
    Het werken met live data biedt erg veel voordelen tijdens het ontwikkelen, zo kan je situaties ontdekken waar je anders niet tegenaan gelopen was, denk bijvoorbeeld aan paginatie die niet werkt als er meer dan 20 items zijn. 
    
    Er zijn een aantal manieren om dit te kunnen bereiken:
    
    \begin{enumerate}
      \item Een master-slave setup waarbij de lokale development server die de database huisvest een slave is van de live (master) database.\footnote{ http://dev.mysql.com/doc/refman/5.1/en/replication.html}
      \item Een script gebaseerd op \emph{mysqldump}\footnote{ http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html} die een dump maakt van bepaalde tabellen die vervolgens op de development database ingeladen kunnen worden.
      \item Gebruik maken van een programma die tussen twee databases kan synchroniseren.
    \end{enumerate}
    
    Van deze drie oplossingen past nummer drie naar mijn mening het beste in de situatie van Fullmoon. Een master-slave is in principe de mooiste manier om lokaal met live gegevens te werken maar als je gaat synchroniseren raak je lokale wijzigingen kwijt. Dat probleem bestaat ook bij oplossing twee. Het {\sc cms} pakket van Fullmoon heeft een aantal tabellen waar alle pagina informatie in staat, als je die overschrijft met data van een andere database ben je de al gemaakte pagina's kwijt.
    
    Daarom lijkt mij optie drie de beste oplossing. Met een programma als Navicat \footnote{ http://www.navicat.com/html/} of EMS DB Comparer \footnote{ http://www.sqlmanager.net/en/products/mysql/dbcomparer} kan je twee databases met elkaar vergelijken en de wijzigingen die je wilt doorvoeren selecteren.
    
    Van deze twee producten ligt mijn voorkeur bij Navicat, dit is eigenlijk een volledig database administratiepakket. Dat biedt als voordeel dat Fullmoon niet veel verschillende programma's naast elkaar hoeft te draaien.
    
    \paragraph{Ik wil Fullmoon aanraden om gebruik te maken van een database synchroniseer programma als Navicat om zelf tijdens het developen recente content op te halen van de live database.}
    
    \subsubsection{Backup}
    
    De databases worden al goed gebackupped door Fullmoon's hosting provider, maar om onafhankelijk van hun te kunnen opereren en zodat je niet op hun hoeft te wachten mocht je een (oudere) backup terug willen halen lijkt het me goed om hier zelf ook in te voorzien.
    
    Je kan natuurlijk alle backups opslaan op een eigen computer of op de development server maar het veiligste is als je dit offsite bewaard. Er zijn tegenwoordig veel bedrijven waarbij je backups kunt opslaan die opereren op het \emph{pay for what you use} principe, waardoor het erg kosteffectief is. Hierin is Amazon Simple Storage Service (S3) de grootste en meest gebruikte. Omdat S3 de beste tools beschikbaar heeft wil ik mijn advies hier graag op baseren. Op het moment van schrijven zijn er al een aantal goede, ik kan er twee aanraden.
        
    \begin{itemize}
      \item \textbf{Tarsnap} (http://www.tarsnap.com) Een betaalde oplossing die zich op dit moment in een publieke beta fase bevindt. Het grote voordeel van Tarsnap is dat het incremental backups opslaat (alleen hetgene wat veranderd is ten opzichte van de vorige backup) waardoor de backups niet groot hoeven te zijn.
      \item \textbf{s3sync} (http://s3sync.net/wiki) Een Ruby library waarmee je zelf een backupscript kunt schrijven.
    \end{itemize}
    
    Tarsnap is een prachtige oplossing maar in Fullmoon's geval worden de backups per nacht aangeleverd in een gecomprimeerd bestand waardoor er geen mogelijkheid is voor incremental backups. Een backup-script gebaseerd op S3sync zal daarom de beste optie zijn.
    
    \paragraph{Naar mijn idee kan Fullmoon het beste ook zelf de database backups opslaan, zodat ze niet afhankelijk zijn van hun hosting provider. Een backup-script wat gebruik maakt van s3sync zal hiervoor de beste oplossing zijn.}
    
    \subsection{Updaten van websites}
  
    Om het updaten van websites te automatiseren zijn er een aantal mogelijkheden. 
    
    \begin{enumerate}
      \item Een script schrijven gebaseerd op {\sc rsync} die bestanden van de ontwikkelserver upload.
      \item Gebruik maken van het {\sc scm} systeem.
    \end{enumerate}
    
    Rsync maakt het makkelijk om bestanden op verschillende servers te synchroniseren maar mijn voorkeur ligt bij de tweede optie, deze is krachtiger in te stellen.
    {\sc scm} systemen maken het mogelijk om een versie van bestanden in de repository een \emph{tag} te geven, bijvoorbeeld ``versie 0.8''. Hierna kan je de live server de opdracht geven om te synchroniseren en alles vanaf deze tag te draaien. Dit geeft als voordeel dat je gemakkelijk kunt zien welke versie een website draait en dat je gemakkelijk terug kunt gaan naar een voorlopende versie.
    
  \section{Conclusie}
  
  Op basis van dit document wil ik deze wijzigingen doorvoeren binnen Fullmoon. Ik denk dat de mate van professionaliteit binnen de workflow erg zal verbeteren en dan met name het samenwerken. Doordat iedereen op zijn eigen computer werkt en niet meer op de centrale server zit niemand elkaar meer in de weg. Ook het overzicht van wie waar mee bezig is en wat hij precies gedaan heeft zal goed van pas komen.

  De meest rigoureuze verandering voor de medewerkers zal het gebruik van een {\sc scm} systeem zijn maar als ze hier eenmaal aan gewend zijn geraakt voorspel ik dat het fijn werken is. Ik heb namelijk zelf gemerkt dat het erg motiverend is als je kan terugzien hoeveel je gedaan hebt!
  
  Ik heb er vertrouwen in dat de situatie bij Fullmoon zal verbeteren en ik ben blij dat ik hun hierbij mag helpen.

\end{document}
